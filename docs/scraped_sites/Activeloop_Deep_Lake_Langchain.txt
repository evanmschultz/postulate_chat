Activeloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes. This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.   For more information, please see the Deep Lake documentation or api reference Integration with LangChain. Create a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly. To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization. Later, you can reload the dataset without recomputing embeddings Deep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock. Let's create another vector store containing metadata with the year the documents were created. Distance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product  Using maximal marginal relevance and if delete fails you can also force delete By default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved here In order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps. Furthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL). you can access the Deep Lake  dataset at db.vectorstore Copy already created dataset to the cloud. You can also transfer from cloud to local. IntegrationsCallbacksChat modelsChat loadersDocument loadersDocument transformersLLMsMemoryRetrieversText embedding modelsAgents & ToolkitsToolsVector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZillizGrouped by provider Callbacks Chat models Chat loaders Document loaders Document transformers LLMs Memory Retrievers Text embedding models Agents & Toolkits Tools Vector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZilliz Activeloop Deep Lake Alibaba Cloud OpenSearch AnalyticDB Annoy Atlas AwaDB Azure Cognitive Search BagelDB Cassandra Chroma ClickHouse DashVector Dingo DocArray HnswSearch DocArray InMemorySearch Elasticsearch Epsilla Faiss Hologres LanceDB Marqo Google Vertex AI MatchingEngine Meilisearch Milvus MongoDB Atlas MyScale Neo4j Vector Index NucliaDB OpenSearch Postgres Embedding PGVector Pinecone Qdrant Redis Rockset ScaNN SingleStoreDB scikit-learn sqlite-vss StarRocks Supabase (Postgres) Tair Tencent Cloud VectorDB Tigris Typesense USearch vearch Vectara Weaviate Xata Zep Zilliz Grouped by provider  Integrations Vector stores Activeloop Deep Lake OpenAIEmbeddings CharacterTextSplitter DeepLake TextLoader RetrievalQA OpenAIChat Setting up Example provided by Activeloop Deep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete dataset Create a local dataset Query dataset Retrieval Question/Answering Attribute based filtering in metadata Choosing distance function Maximal Marginal relevance Delete dataset Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3 TQL Search Creating vector stores on AWS S3 Deep Lake APITransfer local dataset to cloud Transfer local dataset to cloud Discord Twitter Python JS/TS Homepage Blog Skip to main contentü¶úÔ∏èüîó LangChainDocsUse casesIntegrationsAPILangSmithJS/TS DocsCTRLKIntegrationsCallbacksChat modelsChat loadersDocument loadersDocument transformersLLMsMemoryRetrieversText embedding modelsAgents & ToolkitsToolsVector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZillizGrouped by providerIntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearchSetting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloudCommunityDiscordTwitterGitHubPythonJS/TSMoreHomepageBlogCopyright ¬© 2023 LangChain, Inc. Skip to main content ü¶úÔ∏èüîó LangChainDocsUse casesIntegrationsAPILangSmithJS/TS DocsCTRLK ü¶úÔ∏èüîó LangChainDocsUse casesIntegrationsAPI LangSmithJS/TS DocsCTRLK  CTRLK CTRLK  CTRLK   IntegrationsCallbacksChat modelsChat loadersDocument loadersDocument transformersLLMsMemoryRetrieversText embedding modelsAgents & ToolkitsToolsVector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZillizGrouped by providerIntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearchSetting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloud IntegrationsCallbacksChat modelsChat loadersDocument loadersDocument transformersLLMsMemoryRetrieversText embedding modelsAgents & ToolkitsToolsVector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZillizGrouped by providerIntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearchSetting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloud IntegrationsCallbacksChat modelsChat loadersDocument loadersDocument transformersLLMsMemoryRetrieversText embedding modelsAgents & ToolkitsToolsVector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZillizGrouped by provider IntegrationsCallbacksChat modelsChat loadersDocument loadersDocument transformersLLMsMemoryRetrieversText embedding modelsAgents & ToolkitsToolsVector storesActiveloop Deep LakeAlibaba Cloud OpenSearchAnalyticDBAnnoyAtlasAwaDBAzure Cognitive SearchBagelDBCassandraChromaClickHouseDashVectorDingoDocArray HnswSearchDocArray InMemorySearchElasticsearchEpsillaFaissHologresLanceDBMarqoGoogle Vertex AI MatchingEngineMeilisearchMilvusMongoDB AtlasMyScaleNeo4j Vector IndexNucliaDBOpenSearchPostgres EmbeddingPGVectorPineconeQdrantRedisRocksetScaNNSingleStoreDBscikit-learnsqlite-vssStarRocksSupabase (Postgres)TairTencent Cloud VectorDBTigrisTypesenseUSearchvearchVectaraWeaviateXataZepZillizGrouped by provider Integrations Callbacks Chat models Chat loaders Document loaders Document transformers LLMs Memory Retrievers Text embedding models Agents & Toolkits Tools Vector stores Grouped by provider IntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearchSetting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloud IntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearchSetting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloud IntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearch IntegrationsVector storesActiveloop Deep LakeOn this pageActiveloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']PreviousVector storesNextAlibaba Cloud OpenSearch On this page Activeloop Deep LakeActiveloop Deep Lake as a Multi-Modal Vector Store that stores embeddings and their metadata including text, Jsons, images, audio, video, and more. It saves the data locally, in your cloud, or on Activeloop storage. It performs hybrid search including embeddings and their attributes.This notebook showcases basic functionality related to Activeloop Deep Lake. While Deep Lake can store embeddings, it is capable of storing any type of data. It is a serverless data lake with version control, query engine and streaming dataloaders to deep learning frameworks.  For more information, please see the Deep Lake documentation or api referenceSetting up‚Äãpip install openai 'deeplake[enterprise]' tiktokenExample provided by Activeloop‚ÄãIntegration with LangChain.Deep Lake locally‚Äãfrom langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLakeAPI Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLakeimport osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()API Reference:TextLoaderCreate a local dataset‚ÄãCreate a dataset locally at ./deeplake/, then run similarity search. The Deeplake+LangChain integration uses Deep Lake datasets under the hood, so dataset and vector store are used interchangeably. To create a dataset in your own cloud, or in the Deep Lake storage, adjust the path accordingly.db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)Query dataset‚Äãquery = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       To disable dataset summary printings all the time, you can specify verbose=False during VectorStore initialization.print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.Later, you can reload the dataset without recomputing embeddingsdb = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)    Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storageDeep Lake, for now, is single writer and multiple reader. Setting read_only=True helps to avoid acquiring the writer lock.Retrieval Question/Answering‚Äãfrom langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)API Reference:RetrievalQAOpenAIChat    /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(query = "What did the president say about Ketanji Brown Jackson"qa.run(query)    'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'Attribute based filtering in metadata‚ÄãLet's create another vector store containing metadata with the year the documents were created.import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)        Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None       db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]Choosing distance function‚ÄãDistance function L2 for Euclidean, L1 for Nuclear, Max l-infinity distance, cos for cosine similarity, dot for dot product db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Maximal Marginal relevance‚ÄãUsing maximal marginal relevancedb.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]Delete dataset‚Äãdb.delete_dataset()    and if delete fails you can also force deleteDeepLake.force_delete_by_path("./my_deeplake")    Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory‚ÄãBy default, Deep Lake datasets are stored locally. To store them in memory, in the Deep Lake Managed DB, or in any object storage, you can provide the corresponding path and credentials when creating the vector store. Some paths require registration with Activeloop and creation of an API token that can be retrieved hereos.environ["ACTIVELOOP_TOKEN"] = activeloop_token# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None       query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)    Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.tensor_db execution option‚ÄãIn order to utilize Deep Lake's Managed Tensor Database, it is necessary to specify the runtime parameter as {'tensor_db': True} during the creation of the vector store. This configuration enables the execution of queries on the Managed Tensor Database, rather than on the client side. It should be noted that this functionality is not applicable to datasets stored locally or in-memory. In the event that a vector store has already been created outside of the Managed Tensor Database, it is possible to transfer it to the Managed Tensor Database by following the prescribed steps.# Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)    Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        TQL Search‚ÄãFurthermore, the execution of queries is also supported within the similarity_search method, whereby the query can be specified utilizing Deep Lake's Tensor Query Language (TQL).search_id = db.vectorstore.dataset.id[0].numpy()search_id[0]    '8a6ff326-3a85-11ee-b840-13905694aaaf'docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)db.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   Creating vector stores on AWS S3‚Äãdataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)    s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None        Deep Lake API‚Äãyou can access the Deep Lake  dataset at db.vectorstore# get structure of the datasetdb.vectorstore.summary()    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None   # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()Transfer local dataset to cloud‚ÄãCopy already created dataset to the cloud. You can also transfer from cloud to local.import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)    Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)         This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421'] pip install openai 'deeplake[enterprise]' tiktoken pip install openai 'deeplake[enterprise]' tiktoken  from langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLake from langchain.embeddings.openai import OpenAIEmbeddingsfrom langchain.text_splitter import CharacterTextSplitterfrom langchain.vectorstores import DeepLake  API Reference:OpenAIEmbeddingsCharacterTextSplitterDeepLake import osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings() import osimport getpassos.environ["OPENAI_API_KEY"] = getpass.getpass("OpenAI API Key:")activeloop_token = getpass.getpass("activeloop token:")embeddings = OpenAIEmbeddings()  from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings() from langchain.document_loaders import TextLoaderloader = TextLoader("../../modules/state_of_the_union.txt")documents = loader.load()text_splitter = CharacterTextSplitter(chunk_size=1000, chunk_overlap=0)docs = text_splitter.split_documents(documents)embeddings = OpenAIEmbeddings()  API Reference:TextLoader db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True) db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)db.add_documents(docs)# or shorter# db = DeepLake.from_documents(docs, dataset_path="./my_deeplake/", embedding=embeddings, overwrite=True)  query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query) query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)          Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None                Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None                Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None         print(docs[0].page_content) print(docs[0].page_content)      Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.     Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.     Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.  db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query) db = DeepLake(    dataset_path="./my_deeplake/", embedding=embeddings, read_only=True)docs = db.similarity_search(query)      Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storage     Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storage     Deep Lake Dataset in ./my_deeplake/ already exists, loading from the storage  from langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),) from langchain.chains import RetrievalQAfrom langchain.llms import OpenAIChatqa = RetrievalQA.from_chain_type(    llm=OpenAIChat(model="gpt-3.5-turbo"),    chain_type="stuff",    retriever=db.as_retriever(),)  API Reference:RetrievalQAOpenAIChat     /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(     /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(     /home/ubuntu/langchain_activeloop/langchain/libs/langchain/langchain/llms/openai.py:786: UserWarning: You are trying to use a chat model. This way of initializing it is no longer supported. Instead, please use: `from langchain.chat_models import ChatOpenAI`      warnings.warn(  query = "What did the president say about Ketanji Brown Jackson"qa.run(query) query = "What did the president say about Ketanji Brown Jackson"qa.run(query)      'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'     'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'     'The president said that Ketanji Brown Jackson is a former top litigator in private practice and a former federal public defender. She comes from a family of public school educators and police officers. She is a consensus builder and has received a broad range of support since being nominated.'  import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True) import randomfor d in docs:    d.metadata["year"] = random.randint(2012, 2014)db = DeepLake.from_documents(    docs, embeddings, dataset_path="./my_deeplake/", overwrite=True)          Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None                Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None                Dataset(path='./my_deeplake/', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape     dtype  compression      -------    -------    -------   -------  -------      embedding  embedding  (4, 1536)  float32   None           id        text      (4, 1)      str     None        metadata     json      (4, 1)      str     None          text       text      (4, 1)      str     None         db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},) db.similarity_search(    "What did the president say about Ketanji Brown Jackson",    filter={"metadata": {"year": 2013}},)      100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]     100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]     100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 2936.16it/s]    [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013})]  db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos") db.similarity_search(    "What did the president say about Ketanji Brown Jackson?", distance_metric="cos")      [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]     [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]     [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]  db.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?") db.max_marginal_relevance_search(    "What did the president say about Ketanji Brown Jackson?")      [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]     [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]     [Document(page_content='Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections. \n\nTonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service. \n\nOne of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court. \n\nAnd I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='Tonight, I‚Äôm announcing a crackdown on these companies overcharging American businesses and consumers. \n\nAnd as Wall Street firms take over more nursing homes, quality in those homes has gone down and costs have gone up.  \n\nThat ends on my watch. \n\nMedicare is going to set higher standards for nursing homes and make sure your loved ones get the care they deserve and expect. \n\nWe‚Äôll also cut costs and keep the economy going strong by giving workers a fair shot, provide more training and apprenticeships, hire them based on their skills not degrees. \n\nLet‚Äôs pass the Paycheck Fairness Act and paid leave.  \n\nRaise the minimum wage to $15 an hour and extend the Child Tax Credit, so no one has to raise a family in poverty. \n\nLet‚Äôs increase Pell Grants and increase our historic support of HBCUs, and invest in what Jill‚Äîour First Lady who teaches full-time‚Äîcalls America‚Äôs best-kept secret: community colleges.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='A former top litigator in private practice. A former federal public defender. And from a family of public school educators and police officers. A consensus builder. Since she‚Äôs been nominated, she‚Äôs received a broad range of support‚Äîfrom the Fraternal Order of Police to former judges appointed by Democrats and Republicans. \n\nAnd if we are to advance liberty and justice, we need to secure the Border and fix the immigration system. \n\nWe can do both. At our border, we‚Äôve installed new technology like cutting-edge scanners to better detect drug smuggling.  \n\nWe‚Äôve set up joint patrols with Mexico and Guatemala to catch more human traffickers.  \n\nWe‚Äôre putting in place dedicated immigration judges so families fleeing persecution and violence can have their cases heard faster. \n\nWe‚Äôre securing commitments and supporting partners in South and Central America to host more refugees and secure their own borders.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2013}),     Document(page_content='And for our LGBTQ+ Americans, let‚Äôs finally get the bipartisan Equality Act to my desk. The onslaught of state laws targeting transgender Americans and their families is wrong. \n\nAs I said last year, especially to our younger transgender Americans, I will always have your back as your President, so you can be yourself and reach your God-given potential. \n\nWhile it often appears that we never agree, that isn‚Äôt true. I signed 80 bipartisan bills into law last year. From preventing government shutdowns to protecting Asian-Americans from still-too-common hate crimes to reforming military justice. \n\nAnd soon, we‚Äôll strengthen the Violence Against Women Act that I first wrote three decades ago. It is important for us to show the nation that we can come together and do big things. \n\nSo tonight I‚Äôm offering a Unity Agenda for the Nation. Four big things we can do together.  \n\nFirst, beat the opioid epidemic.', metadata={'source': '../../modules/state_of_the_union.txt', 'year': 2012})]  db.delete_dataset() db.delete_dataset()                  DeepLake.force_delete_by_path("./my_deeplake") DeepLake.force_delete_by_path("./my_deeplake")                  os.environ["ACTIVELOOP_TOKEN"] = activeloop_token os.environ["ACTIVELOOP_TOKEN"] = activeloop_token  # Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs) # Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing_python"  # could be also ./local/path (much faster locally), s3://bucket/path/to/dataset, gcs://path/to/dataset, etc.docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(dataset_path=dataset_path, embedding=embeddings, overwrite=True)ids = db.add_documents(docs)      Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None            Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None            Your Deep Lake dataset has been successfully created!        Dataset(path='hub://adilkhan/langchain_testing_python', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None         query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content) query = "What did the president say about Ketanji Brown Jackson"docs = db.similarity_search(query)print(docs[0].page_content)      Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.     Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.     Tonight. I call on the Senate to: Pass the Freedom to Vote Act. Pass the John Lewis Voting Rights Act. And while you‚Äôre at it, pass the Disclose Act so Americans can know who is funding our elections.         Tonight, I‚Äôd like to honor someone who has dedicated his life to serve this country: Justice Stephen Breyer‚Äîan Army veteran, Constitutional scholar, and retiring Justice of the United States Supreme Court. Justice Breyer, thank you for your service.         One of the most serious constitutional responsibilities a President has is nominating someone to serve on the United States Supreme Court.         And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation‚Äôs top legal minds, who will continue Justice Breyer‚Äôs legacy of excellence.  # Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs) # Embed and store the textsusername = "<USERNAME_OR_ORG>"  # your username on app.activeloop.aidataset_path = f"hub://{username}/langchain_testing"docs = text_splitter.split_documents(documents)embedding = OpenAIEmbeddings()db = DeepLake(    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    runtime={"tensor_db": True},)ids = db.add_documents(docs)      Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None             Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None             Your Deep Lake dataset has been successfully created!    |    Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None          search_id = db.vectorstore.dataset.id[0].numpy() search_id = db.vectorstore.dataset.id[0].numpy()  search_id[0] search_id[0]      '8a6ff326-3a85-11ee-b840-13905694aaaf'     '8a6ff326-3a85-11ee-b840-13905694aaaf'     '8a6ff326-3a85-11ee-b840-13905694aaaf'  docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",) docs = db.similarity_search(    query=None,    tql=f"SELECT * WHERE id == '{search_id[0]}'",)  db.vectorstore.summary() db.vectorstore.summary()      Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None     dataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },) dataset_path = f"s3://BUCKET/langchain_test"  # could be also ./local/path (much faster locally), hub://bucket/path/to/dataset, gcs://path/to/dataset, etc.embedding = OpenAIEmbeddings()db = DeepLake.from_documents(    docs,    dataset_path=dataset_path,    embedding=embeddings,    overwrite=True,    creds={        "aws_access_key_id": os.environ["AWS_ACCESS_KEY_ID"],        "aws_secret_access_key": os.environ["AWS_SECRET_ACCESS_KEY"],        "aws_session_token": os.environ["AWS_SESSION_TOKEN"],  # Optional    },)      s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None             s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None             s3://hub-2.0-datasets-n/langchain_test loaded successfully.    Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:10<00:00    \    Dataset(path='s3://hub-2.0-datasets-n/langchain_test', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None          # get structure of the datasetdb.vectorstore.summary() # get structure of the datasetdb.vectorstore.summary()      Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None        Dataset(path='hub://adilkhan/langchain_testing', tensors=['embedding', 'id', 'metadata', 'text'])          tensor      htype      shape      dtype  compression      -------    -------    -------    -------  -------      embedding  embedding  (42, 1536)  float32   None           id        text      (42, 1)      str     None        metadata     json      (42, 1)      str     None          text       text      (42, 1)      str     None     # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy() # get embeddings numpy arrayembeds = db.vectorstore.dataset.embedding.numpy()  import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True) import deeplakeusername = "davitbun"  # your username on app.activeloop.aisource = f"hub://{username}/langchain_testing"  # could be local, s3, gcs, etc.destination = f"hub://{username}/langchain_test_copy"  # could be local, s3, gcs, etc.deeplake.deepcopy(src=source, dest=destination, overwrite=True)      Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])     Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])     Copying dataset: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 56/56 [00:38<00:00    This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy    Your Deep Lake dataset has been successfully created!    The dataset is private so make sure you are logged in!    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])  db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs) db = DeepLake(dataset_path=destination, embedding=embeddings)db.add_documents(docs)           This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']          This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']          This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/davitbun/langchain_test_copy        /    hub://davitbun/langchain_test_copy loaded successfully.        Deep Lake Dataset in hub://davitbun/langchain_test_copy already exists, loading from the storage    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (4, 1536)  float32   None           ids      text     (4, 1)      str     None        metadata    json     (4, 1)      str     None          text      text     (4, 1)      str     None       Evaluating ingest: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1/1 [00:31<00:00    -    Dataset(path='hub://davitbun/langchain_test_copy', tensors=['embedding', 'ids', 'metadata', 'text'])          tensor     htype     shape     dtype  compression      -------   -------   -------   -------  -------      embedding  generic  (8, 1536)  float32   None           ids      text     (8, 1)      str     None        metadata    json     (8, 1)      str     None          text      text     (8, 1)      str     None            ['ad42f3fe-e188-11ed-b66d-41c5f7b85421',     'ad42f3ff-e188-11ed-b66d-41c5f7b85421',     'ad42f400-e188-11ed-b66d-41c5f7b85421',     'ad42f401-e188-11ed-b66d-41c5f7b85421']  Previous Vector stores Next Alibaba Cloud OpenSearch Setting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloud Setting upExample provided by ActiveloopDeep Lake locallyCreate a local datasetQuery datasetRetrieval Question/AnsweringAttribute based filtering in metadataChoosing distance functionMaximal Marginal relevanceDelete datasetDeep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memoryTQL SearchCreating vector stores on AWS S3Deep Lake APITransfer local dataset to cloud CommunityDiscordTwitterGitHubPythonJS/TSMoreHomepageBlogCopyright ¬© 2023 LangChain, Inc. CommunityDiscordTwitterGitHubPythonJS/TSMoreHomepageBlog CommunityDiscordTwitter Community GitHubPythonJS/TS GitHub MoreHomepageBlog More Copyright ¬© 2023 LangChain, Inc. Copyright ¬© 2023 LangChain, Inc. Skip to main content (#docusaurus_skipToContent_fallback) ü¶úÔ∏èüîó LangChain (/) Docs (/docs/get_started/introduction) Use cases (/docs/use_cases) Integrations (/docs/integrations) API (https://api.python.langchain.com) LangSmith (https://smith.langchain.com) JS/TS Docs (https://js.langchain.com/docs)  (https://github.com/hwchase17/langchain) Integrations (/docs/integrations) Callbacks (/docs/integrations/callbacks/) Chat models (/docs/integrations/chat/) Chat loaders (/docs/integrations/chat_loaders/) Document loaders (/docs/integrations/document_loaders/) Document transformers (/docs/integrations/document_transformers/) LLMs (/docs/integrations/llms/) Memory (/docs/integrations/memory/) Retrievers (/docs/integrations/retrievers/) Text embedding models (/docs/integrations/text_embedding/) Agents & Toolkits (/docs/integrations/toolkits/) Tools (/docs/integrations/tools/) Vector stores (/docs/integrations/vectorstores/) Activeloop Deep Lake (/docs/integrations/vectorstores/activeloop_deeplake) Alibaba Cloud OpenSearch (/docs/integrations/vectorstores/alibabacloud_opensearch) AnalyticDB (/docs/integrations/vectorstores/analyticdb) Annoy (/docs/integrations/vectorstores/annoy) Atlas (/docs/integrations/vectorstores/atlas) AwaDB (/docs/integrations/vectorstores/awadb) Azure Cognitive Search (/docs/integrations/vectorstores/azuresearch) BagelDB (/docs/integrations/vectorstores/bageldb) Cassandra (/docs/integrations/vectorstores/cassandra) Chroma (/docs/integrations/vectorstores/chroma) ClickHouse (/docs/integrations/vectorstores/clickhouse) DashVector (/docs/integrations/vectorstores/dashvector) Dingo (/docs/integrations/vectorstores/dingo) DocArray HnswSearch (/docs/integrations/vectorstores/docarray_hnsw) DocArray InMemorySearch (/docs/integrations/vectorstores/docarray_in_memory) Elasticsearch (/docs/integrations/vectorstores/elasticsearch) Epsilla (/docs/integrations/vectorstores/epsilla) Faiss (/docs/integrations/vectorstores/faiss) Hologres (/docs/integrations/vectorstores/hologres) LanceDB (/docs/integrations/vectorstores/lancedb) Marqo (/docs/integrations/vectorstores/marqo) Google Vertex AI MatchingEngine (/docs/integrations/vectorstores/matchingengine) Meilisearch (/docs/integrations/vectorstores/meilisearch) Milvus (/docs/integrations/vectorstores/milvus) MongoDB Atlas (/docs/integrations/vectorstores/mongodb_atlas) MyScale (/docs/integrations/vectorstores/myscale) Neo4j Vector Index (/docs/integrations/vectorstores/neo4jvector) NucliaDB (/docs/integrations/vectorstores/nucliadb) OpenSearch (/docs/integrations/vectorstores/opensearch) Postgres Embedding (/docs/integrations/vectorstores/pgembedding) PGVector (/docs/integrations/vectorstores/pgvector) Pinecone (/docs/integrations/vectorstores/pinecone) Qdrant (/docs/integrations/vectorstores/qdrant) Redis (/docs/integrations/vectorstores/redis) Rockset (/docs/integrations/vectorstores/rockset) ScaNN (/docs/integrations/vectorstores/scann) SingleStoreDB (/docs/integrations/vectorstores/singlestoredb) scikit-learn (/docs/integrations/vectorstores/sklearn) sqlite-vss (/docs/integrations/vectorstores/sqlitevss) StarRocks (/docs/integrations/vectorstores/starrocks) Supabase (Postgres) (/docs/integrations/vectorstores/supabase) Tair (/docs/integrations/vectorstores/tair) Tencent Cloud VectorDB (/docs/integrations/vectorstores/tencentvectordb) Tigris (/docs/integrations/vectorstores/tigris) Typesense (/docs/integrations/vectorstores/typesense) USearch (/docs/integrations/vectorstores/usearch) vearch (/docs/integrations/vectorstores/vearch) Vectara (/docs/integrations/vectorstores/vectara) Weaviate (/docs/integrations/vectorstores/weaviate) Xata (/docs/integrations/vectorstores/xata) Zep (/docs/integrations/vectorstores/zep) Zilliz (/docs/integrations/vectorstores/zilliz) Grouped by provider (/docs/integrations/providers/)  (/) Integrations (/docs/integrations) Vector stores (/docs/integrations/vectorstores/) Activeloop Deep Lake (https://docs.activeloop.ai/) documentation (https://docs.activeloop.ai) api reference (https://docs.deeplake.ai) ‚Äã (#setting-up) ‚Äã (#example-provided-by-activeloop) Integration with LangChain (https://docs.activeloop.ai/tutorials/vector-store/deep-lake-vector-store-in-langchain) ‚Äã (#deep-lake-locally) OpenAIEmbeddings (https://api.python.langchain.com/en/latest/embeddings/langchain.embeddings.openai.OpenAIEmbeddings.html) CharacterTextSplitter (https://api.python.langchain.com/en/latest/text_splitter/langchain.text_splitter.CharacterTextSplitter.html) DeepLake (https://api.python.langchain.com/en/latest/vectorstores/langchain.vectorstores.deeplake.DeepLake.html) TextLoader (https://api.python.langchain.com/en/latest/document_loaders/langchain.document_loaders.text.TextLoader.html) ‚Äã (#create-a-local-dataset) adjust the path accordingly (https://docs.activeloop.ai/storage-and-credentials/storage-options) ‚Äã (#query-dataset) ‚Äã (#retrieval-questionanswering) RetrievalQA (https://api.python.langchain.com/en/latest/chains/langchain.chains.retrieval_qa.base.RetrievalQA.html) OpenAIChat (https://api.python.langchain.com/en/latest/llms/langchain.llms.openai.OpenAIChat.html) ‚Äã (#attribute-based-filtering-in-metadata) ‚Äã (#choosing-distance-function) ‚Äã (#maximal-marginal-relevance) ‚Äã (#delete-dataset) ‚Äã (#deep-lake-datasets-on-cloud-activeloop-aws-gcs-etc-or-in-memory) corresponding path and credentials when creating the vector store (https://docs.activeloop.ai/storage-and-credentials/storage-options) retrieved here (https://app.activeloop.ai/) ‚Äã (#tensor_db-execution-option) ‚Äã (#tql-search) ‚Äã (#creating-vector-stores-on-aws-s3) ‚Äã (#deep-lake-api) ‚Äã (#transfer-local-dataset-to-cloud) PreviousVector stores (/docs/integrations/vectorstores/) NextAlibaba Cloud OpenSearch (/docs/integrations/vectorstores/alibabacloud_opensearch) Setting up (#setting-up) Example provided by Activeloop (#example-provided-by-activeloop) Deep Lake locally (#deep-lake-locally) Create a local dataset (#create-a-local-dataset) Query dataset (#query-dataset) Retrieval Question/Answering (#retrieval-questionanswering) Attribute based filtering in metadata (#attribute-based-filtering-in-metadata) Choosing distance function (#choosing-distance-function) Maximal Marginal relevance (#maximal-marginal-relevance) Delete dataset (#delete-dataset) Deep Lake datasets on cloud (Activeloop, AWS, GCS, etc.) or in memory (#deep-lake-datasets-on-cloud-activeloop-aws-gcs-etc-or-in-memory) TQL Search (#tql-search) Creating vector stores on AWS S3 (#creating-vector-stores-on-aws-s3) Deep Lake API (#deep-lake-api) Transfer local dataset to cloud (#transfer-local-dataset-to-cloud) Discord (https://discord.gg/cU2adEyC7w) Twitter (https://twitter.com/LangChainAI) Python (https://github.com/hwchase17/langchain) JS/TS (https://github.com/hwchase17/langchainjs) Homepage (https://langchain.com) Blog (https://blog.langchain.dev)